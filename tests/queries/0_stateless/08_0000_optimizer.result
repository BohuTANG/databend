--------------
SET max_threads=16
--------------

--------------
SELECT 'filter push down: push (number+1) to filter'
--------------

+---------------------------------------------+
| filter push down: push (number+1) to filter |
+---------------------------------------------+
| filter push down: push (number+1) to filter |
+---------------------------------------------+
--------------
EXPLAIN SELECT (number+1) as a from numbers_mt(10000) where a > 2
--------------

+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| explain                                                                                                                                                                                      |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Projection: (number + 1) as a:UInt64
  Filter: ((number + 1) > 2)
    ReadDataSource: scan partitions: [16], scan schema: [number:UInt64], statistics: [read_rows: 10000, read_bytes: 80000] |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
--------------
SELECT 'limit push down: push (limit 10) to projection'
--------------

+------------------------------------------------+
| limit push down: push (limit 10) to projection |
+------------------------------------------------+
| limit push down: push (limit 10) to projection |
+------------------------------------------------+
--------------
EXPLAIN select (number+1) as c1, number as c2 from numbers_mt(10000) where (c1+c2+1)=1 limit 10
--------------

+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| explain                                                                                                                                                                                                                                             |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Limit: 10
  Projection: (number + 1) as c1:UInt64, number as c2:UInt64
    Filter: ((((number + 1) + number) + 1) = 1)
      ReadDataSource: scan partitions: [16], scan schema: [number:UInt64], statistics: [read_rows: 10000, read_bytes: 80000] |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
--------------
SELECT 'group by push down: push alias to group by'
--------------

+--------------------------------------------+
| group by push down: push alias to group by |
+--------------------------------------------+
| group by push down: push alias to group by |
+--------------------------------------------+
--------------
EXPLAIN select (number+1) as c1, (number%3+1) as c2 from numbers_mt(10000) group by c2
--------------

+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| explain                                                                                                                                                                                                                                                                                                                                                                                                         |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| AggregatorFinal: groupBy=[[((number % 3) + 1) as c2]], aggr=[[(number + 1) as c1, ((number % 3) + 1) as c2]]
  RedistributeStage[state: AggregatorMerge, id: 0]
    AggregatorPartial: groupBy=[[((number % 3) + 1) as c2]], aggr=[[(number + 1) as c1, ((number % 3) + 1) as c2]]
      ReadDataSource: scan partitions: [16], scan schema: [number:UInt64], statistics: [read_rows: 10000, read_bytes: 80000] |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
--------------
SELECT 'projection push down: push (name and value) to readdatasource'
--------------

+---------------------------------------------------------------+
| projection push down: push (name and value) to readdatasource |
+---------------------------------------------------------------+
| projection push down: push (name and value) to readdatasource |
+---------------------------------------------------------------+
--------------
EXPLAIN select name from system.settings where value > 10
--------------

+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| explain                                                                                                                                                                |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Projection: name:Utf8
  Filter: (value > 10)
    ReadDataSource: scan partitions: [1], scan schema: [name:Utf8, value:Utf8], statistics: [read_rows: 0, read_bytes: 0] |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
